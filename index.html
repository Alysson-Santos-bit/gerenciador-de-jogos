<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loja de Games</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* --- ESTILOS GERAIS (O Fundo) --- */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f2f5; /* Cinza bem clarinho moderno */
            margin: 0;
            padding: 20px;
            color: #333;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }

        /* --- O CARD DO FORMUL√ÅRIO --- */
        .card-formulario {
            background: white;
            max-width: 500px;
            margin: 0 auto 40px auto; /* Centraliza na tela */
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); /* Sombra suave */
        }

        .inputs-group {
            display: flex;
            flex-direction: column;
            gap: 15px; /* Espa√ßo entre os inputs */
        }

        input {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: 0.3s;
        }

        input:focus {
            border-color: #3498db; /* Azul ao clicar */
            outline: none;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }

        /* --- BOT√ïES --- */
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: transform 0.1s, filter 0.2s;
        }

        button:active {
            transform: scale(0.98); /* Efeito de clique */
        }

        #btn-salvar {
            background-color: #27ae60; /* Verde */
            color: white;
            width: 100%;
            margin-top: 10px;
        }
        #btn-salvar:hover { background-color: #219150; }

        #btn-cancelar {
            background-color: #95a5a6; /* Cinza */
            color: white;
            width: 100%;
        }

        .btn-editar {
            background-color: #f39c12; /* Laranja */
            color: white;
        }

        .btn-deletar {
            background-color: #e74c3c; /* Vermelho */
            color: white;
        }

        /* --- LISTA DE JOGOS (Cards) --- */
        #lista-jogos {
            list-style: none; /* Tira as bolinhas */
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); /* Responsivo */
            gap: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }

        #lista-jogos li {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            border-left: 5px solid #3498db; /* Detalhe azul na esquerda */
        }

        .jogo-info {
            margin-bottom: 15px;
        }

        .jogo-titulo {
            font-size: 18px;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .jogo-detalhes {
            color: #7f8c8d;
            font-size: 14px;
        }

        .acoes {
            display: flex;
            gap: 10px;
            justify-content: flex-end; /* Bot√µes √† direita */
        }

    </style>
</head>
<body>

    <h1>üéÆ Gerenciador de Games</h1>

    <div class="card-formulario">
        <h3 id="titulo-formulario" style="margin-top:0">Novo Jogo</h3>
        
        <div class="inputs-group">
            <input type="text" id="titulo" placeholder="Nome do Jogo (ex: God of War)">
            <input type="number" id="ano" placeholder="Ano de Lan√ßamento">
            <input type="number" id="preco" placeholder="Pre√ßo (R$)">
            
            <button onclick="salvarJogo()" id="btn-salvar">SALVAR JOGO</button>
            <button onclick="cancelarEdicao()" id="btn-cancelar" style="display:none;">CANCELAR EDI√á√ÉO</button>
        </div>
    </div>

    <ul id="lista-jogos">
        </ul>

    <script>
        // --- A MESMA L√ìGICA DE ANTES (N√ÉO MUDOU NADA IMPORTANTE) ---
        
        let idEdicao = null;
        let jogosGlobais = [];

        async function carregarJogos() {
            const resposta = await fetch("http://localhost:3000/jogos");
            jogosGlobais = await resposta.json();
            
            const lista = document.getElementById("lista-jogos");
            lista.innerHTML = "";

            jogosGlobais.map(jogo => {
                lista.innerHTML += `
                    <li>
                        <div class="jogo-info">
                            <span class="jogo-titulo">${jogo.titulo}</span>
                            <span class="jogo-detalhes">${jogo.ano} ‚Ä¢ R$ ${jogo.preco},00</span>
                        </div>
                        <div class="acoes">
                            <button class="btn-editar" onclick="botaoEditar(${jogo.id})">EDITAR</button>
                            <button class="btn-deletar" onclick="deletarJogo(${jogo.id})">EXCLUIR</button>
                        </div>
                    </li>
                `;
            });
        }

        async function salvarJogo() {
            const titulo = document.getElementById("titulo").value;
            const ano = document.getElementById("ano").value;
            const preco = document.getElementById("preco").value;

            if(!titulo || !ano || !preco) return alert("Preencha tudo!");

            const dados = { titulo, ano: Number(ano), preco: Number(preco) };

            if (idEdicao === null) {
                await fetch("http://localhost:3000/jogos", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(dados)
                });
            } else {
                await fetch("http://localhost:3000/jogos/" + idEdicao, {
                    method: "PUT",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(dados)
                });
            }

            cancelarEdicao();
            carregarJogos();
        }

        function botaoEditar(id) {
            const jogo = jogosGlobais.find(j => j.id === id);
            document.getElementById("titulo").value = jogo.titulo;
            document.getElementById("ano").value = jogo.ano;
            document.getElementById("preco").value = jogo.preco;

            idEdicao = id;
            document.getElementById("titulo-formulario").innerText = "Editando: " + jogo.titulo;
            document.getElementById("btn-salvar").innerText = "ATUALIZAR";
            document.getElementById("btn-salvar").style.backgroundColor = "#f39c12"; // Bot√£o fica laranja
            document.getElementById("btn-cancelar").style.display = "block";
        }

        function cancelarEdicao() {
            idEdicao = null;
            document.getElementById("titulo").value = "";
            document.getElementById("ano").value = "";
            document.getElementById("preco").value = "";

            document.getElementById("titulo-formulario").innerText = "Novo Jogo";
            document.getElementById("btn-salvar").innerText = "SALVAR JOGO";
            document.getElementById("btn-salvar").style.backgroundColor = "#27ae60"; // Volta a ser verde
            document.getElementById("btn-cancelar").style.display = "none";
        }

        async function deletarJogo(id) {
            if (confirm("Tem certeza que deseja excluir?")) {
                await fetch("http://localhost:3000/jogos/" + id, { method: "DELETE" });
                carregarJogos();
            }
        }

        carregarJogos();
    </script>
</body>
</html>